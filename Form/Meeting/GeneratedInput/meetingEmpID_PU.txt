//%attributes = {"lang":"en"} comment added and reserved by 4D.//Project Method: [Meeting].GeneratedInput.meetingEmpID_PU////   Parameter        Type             Description////Description://   ////Date        Init  Description//===============================================================================//15/05/2017   AH   Initial version.DBG_BeginMethod (Current method name)C_LONGINT($vL_FormEvent)$vL_FormEvent:=Form eventCase of : ($vL_FormEvent=On Load)DebugLog ("On Load")// Get a list of managers who are;// a) Flagged as a manager// b) Currently employed (end date is empty or null)ARRAY TEXT(aT_meetingHostUUIDS;0)ARRAY TEXT(aT_meetingEmpHosts;0)CREATE SET([Employee];"Current Selection")QUERY([Employee];[Employee]StartDate<=Current date)QUERY SELECTION([Employee];[Employee]EndDate=!00/00/0000!;*)QUERY SELECTION([Employee]; | ;[Employee]EndDate>Current date)DebugLog ("Found ["+String(Records in selection([Employee]))+"] employees eligible to host")If (OK=1)C_LONGINT($vL_index)// Before adding, ensure the control is empty again$vL_index:=Size of array(aT_meetingEmpHosts)If ($vL_index>0)DELETE FROM ARRAY(aT_meetingEmpHosts;1;$vL_index)End if $vL_index:=Size of array(aT_meetingHostUUIDS)If ($vL_index>0)DELETE FROM ARRAY(aT_meetingHostUUIDS;1;$vL_index)End if FIRST RECORD([Employee])While (Not(End selection([Employee]))APPEND TO ARRAY(aT_meetingEmpHosts;Uppercase([Employee]Surname)+\", "+[Employee]FirstName+", "+[Employee]Mobile)APPEND TO ARRAY(aT_meetingHostUUIDS;[Employee]ID)NEXT RECORD([Employee])End while End if USE SET("Current Selection"): ($vL_FormEvent=On Clicked)DebugLog ("On clicked - TODO")End case DBG_EndMethod 